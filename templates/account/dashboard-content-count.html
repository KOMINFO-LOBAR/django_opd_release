{% extends "account/base-dashboard.html" %}
{% load static %}

{% block content %}
    <!-- MAIN PANEL -->
    <div id="main" role="main">
    
        <!-- RIBBON -->
        <div id="ribbon">
            <span class="ribbon-button-alignment"> 
                <span id="refresh" class="btn btn-ribbon" data-action="resetWidgets" data-title="refresh"  rel="tooltip" data-placement="bottom" data-original-title="<i class='text-warning fa fa-warning'></i> Warning! This will reset all your widget settings." data-html="true">
                    <i class="fa fa-refresh"></i>
                </span> 
            </span>

            <!-- breadcrumb -->
            <ol class="breadcrumb">   
                <li>Selamat Datang, {{ user.username|default:'Guest'|title }} - [ {{namaOPD}} ] <!--</li><li>Miscellaneous</li><li>Blank Page</li>-->                
            </ol>
            <!-- end breadcrumb -->

            <!-- You can also add more buttons to the
            ribbon for further usability
            Example below:
            <span class="ribbon-button-alignment pull-right">
            <span id="search" class="btn btn-ribbon hidden-xs" data-title="search"><i class="fa-grid"></i> Change Grid</span>
            <span id="add" class="btn btn-ribbon hidden-xs" data-title="add"><i class="fa-plus"></i> Add</span>
            <span id="search" class="btn btn-ribbon" data-title="search"><i class="fa-search"></i> <span class="hidden-mobile">Search</span></span>
            </span> -->
        </div>
        <!-- END RIBBON -->

        <!-- MAIN CONTENT -->
        <div id="content">

            <!-- row -->
            <div class="row">
                
                <!-- col -->
                <div class="col-xs-12 col-sm-7 col-md-7 col-lg-6">
                    <h1 class="page-title txt-color-blueDark">
                        
                        <!-- PAGE HEADER -->                        
                        {% for i in menu_aktif %}
                            {% if i.icon != '' %}
                                <i class="fa-fw fa fa-{{i.icon}}"></i> 
                            {% else %}
                                <i class="fa-fw fa fa-home"></i> 
                            {% endif %}
                                {{i.nama}}
                            <!-- <span>>  
                                Grid
                            </span> -->
                        {% endfor %}
                    </h1>
                </div>
                <!-- end col -->
                
                <!-- right side of the page with the sparkline graphs -->

                <!-- Posisi inline graph -->
                &nbsp;
				<div class="col-xs-12 col-sm-5 col-md-5 col-lg-6">
					<!-- sparks -->
					
					
					<select name="category_id" class="select2_category" style="width: 100%; ">
					</select>
					<!--&nbsp;
					<select name="month_id" class="select2_month" style="width: 100%; ">
					</select>
					&nbsp;-->
					<!-- end sparks -->
				</div>
				&nbsp;
				
                    
                
       
            </div>
            
            <div class="row">
				<div class="col-xs-12 col-sm-7 col-md-7 col-lg-6">
					&nbsp;
				</div>
				
				<div class="col-xs-12 col-sm-5 col-md-5 col-lg-6">
					<select name="month_id" class="select2_month" style="width: 100%; ">
					</select>
				</div>
				&nbsp;
            </div>
			

            


            <!-- end row -->


            <!--
                The ID "widget-grid" will start to initialize all widgets below 
                You do not need to use widgets if you dont want to. Simply remove 
                the <section></section> and you can use wells or panels instead 
                -->



            <section id="widget-grid" class="">
            
                <!-- row -->
                <div class="row">


                    <!-- NEW WIDGET START -->
                    <article class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
    
                        <!-- Widget ID (each widget will need unique ID)-->
                        <div class="jarviswidget" id="wid-id-0" data-widget-colorbutton="false"	
                        data-widget-editbutton="false"
                        data-widget-togglebutton="false"
                        data-widget-deletebutton="false"
                        data-widget-fullscreenbutton="false"
                        data-widget-custombutton="false"
                        data-widget-collapsed="false" 
                        data-widget-sortable="false">
                            <!-- widget options:
                                usage: <div class="jarviswidget" id="wid-id-0" data-widget-editbutton="false">
                                data-widget-colorbutton="false" data-widget-fullscreenbutton="false" data-widget-editbutton="false" data-widget-sortable="false"

                                data-widget-colorbutton="false"	
                                data-widget-editbutton="false"
                                data-widget-togglebutton="false"
                                data-widget-deletebutton="false"
                                data-widget-fullscreenbutton="false"
                                data-widget-custombutton="false"
                                data-widget-collapsed="true" 
                                data-widget-sortable="false"
                                
                            -->
                            <header>                                
                                <!-- <h2>Kontribusi Pada Website</h2> -->
                                {% for i in menu_aktif %}
                                    <span class="widget-icon"> 
                                    {% if i.icon != '' %}
                                        <i class="fa-fw fa fa-{{i.icon}}"></i> 
                                    {% else %}
                                        <i class="fa-fw fa fa-home"></i> 
                                    {% endif %}
                                    </span>

                                    <!-- <h2>{{i.nama}} </h2> -->
                                    <h2>Kontribusi Pada Website Detail</h2>
                                    
                                {% endfor %}
                                
                                
                            </header>

                            <!-- widget div-->
                            <div>
                                
                                <!-- widget edit box -->
                                <div class="jarviswidget-editbox">
                                    <!-- This area used as dropdown edit box -->
                                    <input class="form-control" type="text">	
                                </div>
                                <!-- end widget edit box -->
                                
                                <!-- widget content -->
                                <div class="widget-body">
                                    
                                    <!-- this is what the user will see -->
                                    <!-- <canvas id="pieChart" height="120"></canvas> -->

                                    
                                    
                                    <table id="id_kontribusi_kualitas_periode" class="table table-striped table-bordered table-hover" width="100%">
                                        <thead>
                                            <tr>
												<!--No, OPD, domain, jumlha publs, persentase, ket per bulan-->
                                                <th>ID</th>                                                                                                        
                                                <th data-hide="expand">Instansi</th>
                                                <th data-hide="phone,tablet">Jumlah Publish</th>                                                    
                                                <th data-hide="phone,tablet">Persentase (%)</th>                                                    
                                                <th data-hide="phone,tablet">Keterangan</th>                                                                                                                                                    
                                            </tr>
                                        </thead>
                                        <tbody></tbody>
                                    </table>

                                    <!--<hr>
                                    <table id="id_kontribusi_kualitas_table" class="table table-striped table-bordered table-hover" width="100%">
                                        <thead>
                                            <tr>
                                                <th>ID</th>                                                                                                        
                                                <th data-hide="expand">Instansi dengan Kontribusi Berkualitas</th>
                                                <th data-hide="phone,tablet">Berita [100 kata]</th>                                                    
                                                <th data-hide="phone,tablet">Pengumuman [50 kata]</th>                                                    
                                                <th data-hide="phone,tablet">Artikel [100 kata]</th>                                                                                                    
                                                <th data-hide="phone,tablet">Jumlah</th>                                                                                                                                                                                                                                                               
                                            </tr>
                                        </thead>
                                        <tbody></tbody>
                                    </table>
									-->
                                </div>
                                <!-- end widget content -->
                                
                            </div>
                            <!-- end widget div -->
                            
                        </div>
                        <!-- end widget -->


            
                    </article>
                    <!-- WIDGET END -->  
                </div>
            </section>


        </div>
        <!-- END MAIN CONTENT -->

    </div>
    <!-- END MAIN PANEL -->
{% endblock %}

{% block jquery-doc-ready %}  

    // HitCount graph
    var bln = "{{mChartHit.bulan}}";
    var line_hit_array = {{mChartHit.hit}};  
    var line_bln_array = bln.split(",");

    // news count graph
    var bln = "{{mChartNews.bulan}}";
    var news_berita_array = {{mChartNews.berita}};
    var news_pengumuman_array = {{mChartNews.pengumuman}};
    var news_artikel_array = {{mChartNews.artikel}};
    var news_bln_array = bln.split(",");
    
	//kontribusi_kualitas_periode_ajax/1/1.2024         
	
    function kontribusi_kualitas_periode(kategori_id, periode_id) {
        //console.log('kontribusi_kuantitas_table', kategori_id)
        var responsiveHelper_datatable_tabletools = undefined;
        $('#id_kontribusi_kualitas_periode').dataTable({
            //"processing": true,
            ajax: {            
                //"processing": true,
                "url": "/dashboard/kontribusi_kualitas_periode_ajax/"+ kategori_id + "/" + periode_id,
                "dataSrc": ""
            },
            columns:[
                {data: "id"},                        
                {data: "domain"},                
                {data: "total"},
                {data: "persentase"},
                {data: "ket"},                
            ],     
            "order": [[ 3, "desc" ]],                                  
            "aoColumnDefs": [
                        {
                            "targets": [ 0 ],
                            "visible": false,
                            "searchable": false
                        }, 
                        
            ],       
            
            "sDom": "<'dt-toolbar text-right'<'col-xs-12 col-sm-6 hidden-xs'f><'toolbar'>r>"+                
                    "t"+
                    "<'dt-toolbar-footer'<'col-sm-6 col-xs-12 hidden-xs'i><'col-sm-6 col-xs-12'p>>",      
            "autoWidth" : true,
            "oLanguage": {
                "sSearch": '<span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span>'
            },		                                   
        });
    };

    

    // Keterisian Menu
    
    
    
    // Table grid //

    var breakpointDefinition = {
        tablet : 1024,
        phone : 480 
    };    

    
    var responsiveHelper_datatable_tabletools = undefined;
    $('#datatable_tabletools').dataTable({
        //"processing": true,
        ajax: {            
            //"processing": true,
            "url": "/dashboard/site_activity_ajax/",
            "dataSrc": ""
        },
        columns:[
            {data: "id"},                        
            {data: "domain"},
            {render: function ( data, type, row ) {
                return (row.total_menu - row.terisi);
                }
            },
            {data: "terisi"},
            {data: "total_menu"},
            
            {data: "persen",             
                    render: function ( data, type, row ) {
                        return data.toFixed(2);
                    }                
            }, 
            
            {render: function ( data, type, row ) {     // grafik punya
                // Jika KOLOM di create dengan cara ini , maka aoColumnDefs tidak berfungsi lagi untuk target kolom ini saja

                //console.log('data');
                //console.log(row);
                //foreach i in row {
                //    console.log(i.updated_at);
                //}

                    return  ('<span class="spark">100,' + (row.persen).toFixed(2) + ',100</span>' +
                            "<span class='label txt-color-blueDark'> " + (row.persen).toFixed(2) + " %</span>");                    
                }
                
            },    

            //{data: "persen"},       // untuk Grafik

            //    render: function ( data, type, row ) {
            //            return  "<span class='dynamicbar'>" + (row.persen).toFixed(2) + "</span> ";
                                //" <span class='label txt-color-blueDark'> " + row.persen + " %</span>";

                        //var col = "[&quot;#CCD7DB&quot;, &quot;#92A2A8&quot;, &quot;#57889C&quot;]";

                        //return "<span class='sparkline display-inline'" +
                        //"data-sparkline-type='bullet'" +
                        //"data-sparkline-height='14px'" +
                        //"data-sparkline-bulletrange-color='" + col + "'" + 
                        //"data-sparkline-performance-color='#A4CBDB'" +
                        //"data-sparkline-bullet-color='#143644'>" + row.persen + ", 100</span>" +
                        //"<span class='label txt-color-blueDark pull-left'> " + row.persen + " % </span>";                                                
                    
                        // "<div class='toolbar text-right'><button onclick='do_edit(" + row.id + ");' class='btn btn-success btn-xs' title='Edit Data'> "+
                        //"    <i class='fa fa-edit'></i> "+                                                           
                        //"</button> "+
                        //"<button onclick='do_delete(" + row.id + ", \"" + row.judul + "\"" + ");' class='btn btn-danger btn-xs' title='Hapus Data'> "+
                        //"    <i class='fa fa-eraser'></i> "+                                                           
                        //"</button>"+
                        //"</div>";
            //        }
                
            //},   
        ],     
        "order": [[ 5, "desc" ]],   
        //"columnDefs": [
        //    {
        //        "targets": [ 0 ],
        //        "visible": false,
        //        "searchable": false
        //    },  

                 
            //{
            //    "aTargets": [4],
            //    "mRender": function (data, type, full) {
            //        return '<span class="spark">' + data + '100,100</span>';
            //    }
            //},
            
        //], 
        "aoColumnDefs": [
                    {
                        "targets": [ 0 ],
                        "visible": false,
                        "searchable": false
                    }, 
                    //{
                    //    "aTargets": [4],
                    //    "mRender": function (data, type, full) {
                    //         // since data is an array of values [1,2,3,4]
                    //        //console.log(data);
                    //        return (data.toFixed(2));
                    //    }
                    //},
                    //{
                    //    "aTargets": [4],
                    //    "mRender": function (data, type, full) {
                    //         // since data is an array of values [1,2,3,4]
                    //        console.log(data);
                    //        return '<span class="spark">100,' + data + ',100</span>' +
                    //               "<span class='label txt-color-blueDark'> " + data + " %</span>"
                    //    }
                    //}
        ],       
        
        "sDom": "<'dt-toolbar text-right'<'col-xs-12 col-sm-6 hidden-xs'f><'toolbar'>r>"+                
                "t"+
                "<'dt-toolbar-footer'<'col-sm-6 col-xs-12 hidden-xs'i><'col-sm-6 col-xs-12'p>>",      
        "autoWidth" : true,
        "oLanguage": {
            "sSearch": '<span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span>'
        },		            
        "preDrawCallback" : function() {
            // Initialize the responsive datatables helper once.
            if (!responsiveHelper_datatable_tabletools) {
                responsiveHelper_datatable_tabletools = new ResponsiveDatatablesHelper($('#datatable_tabletools'), breakpointDefinition);
            }
        },
        "rowCallback" : function(nRow) {
            responsiveHelper_datatable_tabletools.createExpandIcon(nRow);

            //var tmp = $(nRow).find('.dynamicbar');
            //var myvalues = tmp.text();
            //console.log(myvalues);

            //console.log($(nRow).find('.dynamicbar'));
            

            //$(nRow).find('.dynamicbar').sparkline(myvalues, {type: 'bar', barColor: 'green'} );

            //$('.dynamicbar16').sparkline(myvalues, {type: 'bar', barColor: 'green'} );
            //console.log($('.dynamicbar16'));

            //tmp.sparkline('html', {type: 'bar', barColor: 'red'} );

        },
        "drawCallback" : function(oSettings) {
            responsiveHelper_datatable_tabletools.respond();

            //console.log('callback');
            //console.log($('.spark:not(:has(canvas))'));
            $('.spark:not(:has(canvas))').sparkline('html', {
                type: 'bullet',
                
                
                
                rangeColor: ['#d3dafe','#a8b6ff','#7f94ff'],
                performanceColor: '#3030f0',
                targetColor: '#f03030',
            });
        
        },
        createdRow: function (row, data, index) {
            //if (data[5].replace(/[\$,]/g, '') * 1 > 150000) {
            //    $('td', row).eq(5).addClass('highlight');
            //}
            //console.log($('dynamicbar', row));
            //var myvalues = $(row).find('.dynamicbar').text();
            //console.log(myvalues);

            //$(row).find('.dynamicbar').addClass('highlight');
            //$('span', row).addClass('highlight');
            //console.log($('span', row).sparkline(myvalues, {type: 'bar', barColor: 'green'}));

            //console.log($(row).find('.dynamicbar').text());

            //$('dynamicbar', row).sparkline(80, {type: 'bar', barColor: 'green'} );
            //console.log(row);
        },

        //"fnInitComplete": function(oSettings, json) {
        //    alert( 'DataTables has finished its initialisation.' );
        //},

        //"fnDrawCallback": function (oSettings) {
        //    $('.spark:not(:has(canvas))').sparkline('html', {
        //        type: 'line',
        //        minSpotColor: 'red',
        //        maxSpotColor: 'green',
        //        spotColor: false
        //    });
        //}
    });



    //var grand_total = "{{mGrandTotal}}";
// -----------------------

    // keterisian detail
    //var grand_total = "{{mGrandTotal}}";
    var siteid = {{siteid}};

    // TINGAAL sis data select2 dengan data siteID
    console.log('siteid = ');
    console.log(siteid);

    var site_id_data = {{form_data|safe}};
    console.log(site_id_data);

    var instansi_kategori_id_data = {{form_data_kategori|safe}};
    var month_id_data = {{form_data_month|safe}};
    
    console.log('instansi_kategori_id_data = ');
    console.log(instansi_kategori_id_data);
    
    $(".select2_category").select2();
    $(".select2_month").select2();

    var responsiveHelper_datatable_tabletools3 = undefined;
    $('#datatable_tabletools3').dataTable({
        //"processing": true,
        ajax: {            
            //"processing": true,
            "url": "/dashboard/site_activity_detail_ajax/" + siteid,
            "dataSrc": ""
        },
        columns:[
            {data: "id"},                        
            {data: "parent"},
            {data: "menu"},
            {data: "judul"},
            {data: "terisi", 
                
                render: function ( data, type, row ) {
                    if (data==1) {
                        return '<i class="glyphicon glyphicon-ok"></i>';
                    }
                    else {
                        
                        return null;
                    }
                }            
            },                                    
        ],     
        "order": [[ 4, "desc" ]],   
        //"columnDefs": [
        //    {
        //        "targets": [ 0 ],
        //        "visible": false,
        //        "searchable": false
        //    },  

                
            //{
            //    "aTargets": [6],
            //    "mRender": function (data, type, full) {
            //        return '<span class="spark">' + data + '100,100</span>';
            //    }
            //},
            
        //], 
        "aoColumnDefs": [
                    {
                        "targets": [ 0 ],
                        "visible": false,
                        "searchable": false
                    }, 
                    //{
                    //    "aTargets": [6],
                    //    "mRender": function (data, type, full) {
                            // since data is an array of values [1,2,3,4]
                    //        console.log(data);
                    //        return '<span class="spark">' + data + '</span>' +
                    //               "<span class='label txt-color-blueDark'> " + data + " %</span>"
                    //    }
                    //}
        ],       
        
        //"sDom": "Bfrtip",
        //"dom": "<'row'<'col-sm-6'Bl><'col-sm-6'f>>" +
        //        "<'row'<'col-sm-12'tr>>" +
        //        "<'row'<'col-sm-5'i><'col-sm-7'p>>", //'Bfrtip',   

        //"buttons": [
        //    {
        //        text: "<i class='fas fa-plus'></i>",
        //        action: function ( e, dt, node, config ) {
        //            location.replace("add/")
        //            // alert( 'Button Add' + e );
        //            //test();
        //            //$("#myModal").modal();
        //        },
        //        titleAttr: 'Tambah Data Baru',                        
        //    },
        //    {   extend: 'excel',
        //        text: '<i class="fas fa-file-excel"></i>',
        //        titleAttr: 'Export ke Excel'
        //    },
        //],

        "sDom": "<'dt-toolbar text-right'<'col-xs-12 col-sm-6 hidden-xs'f><'toolbar3'>r>"+                
                "t"+
                "<'dt-toolbar-footer'<'col-sm-6 col-xs-12 hidden-xs'i><'col-sm-6 col-xs-12'p>>",      
        "autoWidth" : true,
        "oLanguage": {
            "sSearch": '<span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span>'
        },	
        	            
        "preDrawCallback" : function() {
            // Initialize the responsive datatables helper once.
            if (!responsiveHelper_datatable_tabletools3) {
                responsiveHelper_datatable_tabletools3 = new ResponsiveDatatablesHelper($('#datatable_tabletools3'), breakpointDefinition);
            }
        },
        "rowCallback" : function(nRow) {
            responsiveHelper_datatable_tabletools3.createExpandIcon(nRow);

            //var tmp = $(nRow).find('.dynamicbar');
            //var myvalues = tmp.text();
            //console.log(myvalues);

            //console.log($(nRow).find('.dynamicbar'));
            

            //$(nRow).find('.dynamicbar').sparkline(myvalues, {type: 'bar', barColor: 'green'} );

            //$('.dynamicbar16').sparkline(myvalues, {type: 'bar', barColor: 'green'} );
            //console.log($('.dynamicbar16'));

            //tmp.sparkline('html', {type: 'bar', barColor: 'red'} );

        },
        "drawCallback" : function(oSettings) {
            responsiveHelper_datatable_tabletools3.respond();

            //console.log('callback');
            //console.log($('.spark:not(:has(canvas))'));
            //console.log('inside draw call back');
            //console.log($('.dt-select2')); // .select2({tags: true, width: "6em"});
            
        
        },
        "fnInitComplete": function(oSettings, json) {
            //alert( 'DataTables has finished its initialisation.' );
            
        },
        
    }); // .buttons().container().appendTo('#example1_wrapper .col-md-6:eq(0)');      


    // custom toolbar

    // style="width: 10%;" text-right GARA2 ini : form-control dihilangkan dari class select
    $("div.toolbar3").html(
        '<div style="text-align: left;">' +
        '<select name="site_id" class="select2_site" style="width: 50%; ">' + 
        '</select>' +
        '</div>'
    );
    
    // ----- begin select2_category

    $('.select2_category').select2({
        ajax: {
            url: '/dashboard/instansi_kategori_ajax/',
            delay: 250, // wait 250 milliseconds before triggering the request
            dataType: 'json',
            data: function (params) {
                var query = {
                    search: params.term,
                    page: params.page || 1
                    // type: 'public'
                };

                // Query parameters will be ?search=[term]&type=public
                return query;
            },
            processResults: function (data, params) {
                params.page = params.page || 1;

                return {
                    results: data.results,
                    pagination: {
                        more: (params.page * 10) < data.count_filtered
                    }
                };
            },
        },
        theme: 'bootstrap4',
    // placeholder: "Pilih Kategori",
        allowClear: true,
    });
    

    $('.select2_category').on('select2:open', () => {
        this.querySelector('.select2-search__field').focus();
    });

    var is_first_enter = true;    

    $('.select2_category').on('select2:select', function (e) {
        var data = e.params.data;
        var kategori_id = data.id;
        console.log('categori',kategori_id);
        
        //var data2;
		//var periode_id = $(".select2_month").select2().val();
		var periode_id = $(".select2_month").select2("data", data, true);
		console.log('select2_category periode_id', periode_id.length);
		if (periode_id.length>0) {
			console.log('ENTER kategoris');
			periode_id = periode_id[0].id;
			console.log('select2_category periode',periode_id);
		
			//kontribusi_kualitas(kategori_id);     
			  
			//kontribusi_kuantitas(kategori_id);     

			//console.log('datatable exists', $('#id_kontribusi_kuantitas_table').DataTable());
			if (!is_first_enter) {
				//console.log('reload');
				$('#id_kontribusi_kualitas_periode').DataTable().ajax.url("/dashboard/kontribusi_kualitas_periode_ajax/" + kategori_id + "/" + periode_id).load();            
				
			//    $('#id_kontribusi_kualitas_table').DataTable().ajax.url("/dashboard/site_kontribusi_kualitas_table_ajax/" + kategori_id).load();            
			}
			else {
				//console.log('create');
				is_first_enter = !is_first_enter
				kontribusi_kualitas_periode(kategori_id, periode_id);    
				    
			//    kontribusi_kualitas_table(kategori_id);        
			};
		};
    });    
    
    $(".select2_category").select2("trigger", "select", {
        //data: { id: {{form_provinsi.id}}, text: {{form_provinsi.name}} }    
        
        data : instansi_kategori_id_data        
    });    

    // ----- end select2_category
    
// -----------------------
    // ----- begin select2_month

    $('.select2_month').select2({
        ajax: {
            url: '/dashboard/post_range_ajax/',
            delay: 250, // wait 250 milliseconds before triggering the request
            dataType: 'json',
            data: function (params) {
                var query = {
                    search: params.term,
                    page: params.page || 1
                    // type: 'public'
                };
                
                // Query parameters will be ?search=[term]&type=public
                return query;
            },
            processResults: function (data, params) {
                params.page = params.page || 1;

                return {
                    results: data.results,
                    pagination: {
                        more: (params.page * 10) < data.count_filtered
                    }
                };
            },
        },
        theme: 'bootstrap4',
        // placeholder: "Pilih Kategori",
        allowClear: true,
    });
    

    $('.select2_month').on('select2:open', () => {
        this.querySelector('.select2-search__field').focus();
    });

    //var is_first_enter = true;    

    $('.select2_month').on('select2:select', function (e) {
        var data = e.params.data;
        var periode_id = data.id;
		console.log('periode_id', periode_id);
		
		var kategori_id = $(".select2_category").select2("data", data, true);
		console.log('kategori',kategori_id);
		
		if (kategori_id.length>0) {
			console.log('ENTER month');
			kategori_id = kategori_id[0].id;
		
			//kontribusi_kualitas(kategori_id);              
			//kontribusi_kuantitas(kategori_id);     

			//console.log('datatable exists', $('#id_kontribusi_kuantitas_table').DataTable());
			if (!is_first_enter) {
				//console.log('reload');
				//$('#id_kontribusi_kuantitas_table').DataTable().ajax.url("/dashboard/site_kontribusi_kuantitas_table_ajax/" + kategori_id).load();            
				$('#id_kontribusi_kualitas_periode').DataTable().ajax.url("/dashboard/kontribusi_kualitas_periode_ajax/" + kategori_id + "/" + periode_id).load();            
			//    $('#id_kontribusi_kualitas_table').DataTable().ajax.url("/dashboard/site_kontribusi_kualitas_table_ajax/" + kategori_id).load();            
			}
			else {
				//console.log('create');
				is_first_enter = !is_first_enter
				kontribusi_kualitas_periode(kategori_id, periode_id);        
			//    kontribusi_kualitas_table(kategori_id);        
			};
		};
    });    
    
    $(".select2_month").select2("trigger", "select", {
        //data: { id: {{form_provinsi.id}}, text: {{form_provinsi.name}} }    
        
        data : month_id_data        
    });    

    // ----- end select2_month

// -----------------------


    {% for message in messages %}                                        		
        $.smallBox({
            title : "<i class='fa fa-desktop'></i> &nbsp;&nbsp; {{message|safe}}",
            content : "<i class='fa fa-link'></i> <i>Dashboard</i>",
            color : "#296191",
            iconSmall : "fa fa-thumbs-up bounce animated",
            timeout : 4000
        });
    {% endfor %}
    $("html,body").animate({scrollTop: 0}, 1000);

{% endblock %}

{% block related-plugin %}   
    <script src="{% static 'account/js/plugin/datatables/jquery.dataTables.min.js' %}"></script>
	<script src="{% static 'account/js/plugin/datatables/dataTables.colVis.min.js' %}"></script>
	<script src="{% static 'account/js/plugin/datatables/dataTables.tableTools.min.js' %}"></script>
	<script src="{% static 'account/js/plugin/datatables/dataTables.bootstrap.min.js' %}"></script>
	<script src="{% static 'account/js/plugin/datatable-responsive/datatables.responsive.min.js' %}"></script>

    <script src="{% static 'account/js/jquery.sparkline.js' %}"></script>
    <!-- sparkle referensi : -->
    <!-- https://stackoverflow.com/questions/51735975/getting-datatables-and-sparklines-to-play-nice-together -->
    <!-- https://omnipotent.net/jquery.sparkline/#bullet -->

    <!-- SmartChat UI : plugin -->
    <!-- <script src="{% static 'account/js/smart-chat-ui/smart.chat.ui.min.js' %}"></script>
    <script src="{% static 'account/js/smart-chat-ui/smart.chat.manager.min.js' %}"></script> -->
    
    <script src="{% static 'account/js/plugin/moment/moment.min.js' %}"></script>
	<script src="{% static 'account/js/plugin/chartjs/chart.min.js' %}"></script>

    <script src="{% static 'account/js/highchart/highcharts.js' %}"></script>
    <script src="{% static 'account/js/highchart/data.js' %}"></script>
    <script src="{% static 'account/js/highchart/drilldown.js' %}"></script>

    <script src="{% static 'account/js/highchart/exporting.js' %}"></script>
    <script src="{% static 'account/js/highchart/export-data.js' %}"></script>
    <script src="{% static 'account/js/highchart/accessibility.js' %}"></script>
{% endblock %}
