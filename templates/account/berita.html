{% extends "account/base-dashboard.html" %}
{% load static %}
{% load humanize %} 

{% block content %}
    <!-- MAIN PANEL -->
    <div id="main" role="main">

        <!-- RIBBON -->
        <div id="ribbon">

            <span class="ribbon-button-alignment"> 
                <span id="refresh" class="btn btn-ribbon" data-action="resetWidgets" data-title="refresh"  rel="tooltip" data-placement="bottom" data-original-title="<i class='text-warning fa fa-warning'></i> Warning! This will reset all your widget settings." data-html="true">
                    <i class="fa fa-refresh"></i>
                </span> 
            </span>
 
            <!-- breadcrumb -->
            <ol class="breadcrumb">   
                <li>Selamat Datang, {{ user.username|default:'Guest'|title }} - [ {{namaOPD}} ] <!--</li><li>Miscellaneous</li><li>Blank Page</li>-->
            </ol>
            <!-- end breadcrumb  -->

            <!-- You can also add more buttons to the  
            ribbon for further usability
 
            Example below:   

            <span class="ribbon-button-alignment pull-right">
            <span id="search" class="btn btn-ribbon hidden-xs" data-title="search"><i class="fa-grid"></i> Change Grid</span>
            <span id="add" class="btn btn-ribbon hidden-xs" data-title="add"><i class="fa-plus"></i> Add</span>
            <span id="search" class="btn btn-ribbon" data-title="search"><i class="fa-search"></i> <span class="hidden-mobile">Search</span></span>
            </span> -->

        </div>
        <!-- END RIBBON -->

        <!-- MAIN CONTENT -->
        <div id="content">

            <!-- row -->
            <div class="row">
                
                <!-- col -->
                <div class="col-xs-12 col-sm-7 col-md-7 col-lg-4">
                    <h1 class="page-title txt-color-blueDark">
                        <!--berita aktif = {{menu_aktif}}-->
                        <!-- PAGE HEADER -->
                        {% for i in menu_aktif %}
                            {% if i.icon != '' %}
                                <i class="fa-fw fa fa-{{i.icon}}"></i> 
                            {% else %}
                                <i class="fa-fw fa fa-home"></i> 
                            {% endif %}
                                {{i.nama}}
                            <span>>  
                                Grid
                            </span>
                        {% endfor %}
                    </h1>
                </div>
                <!-- end col -->
                
                <!-- right side of the page with the sparkline graphs -->

                <!-- Posisi inline graph -->
                
            </div>
            <!-- end row -->
            
            <!--
                The ID "widget-grid" will start to initialize all widgets below 
                You do not need to use widgets if you dont want to. Simply remove 
                the <section></section> and you can use wells or panels instead 
                -->
            
            <!-- widget grid -->
            <section id="widget-grid" class="">
            
                <!-- row -->
                <div class="row">



                    <!-- NEW WIDGET START -->
                    <article class="col-sm-12 col-md-12 col-lg-12">
                                                                
                        <!-- Widget ID (each widget will need unique ID)-->
                        <div class="jarviswidget jarviswidget-color-blueLight" id="wid-id-10" data-widget-colorbutton="false" data-widget-editbutton="false" data-widget-togglebutton="false" data-widget-deletebutton="false" data-widget-fullscreenbutton="false" data-widget-custombutton="false" data-widget-sortable="false">
                            <!-- widget options:
                            usage: <div class="jarviswidget" id="wid-id-0" data-widget-editbutton="false">

                            data-widget-colorbutton="false"
                            data-widget-editbutton="false"
                            data-widget-togglebutton="false"
                            data-widget-deletebutton="false"
                            data-widget-fullscreenbutton="false"
                            data-widget-custombutton="false"
                            data-widget-collapsed="true"
                            data-widget-sortable="false"

                            -->
                            <header>
                                <span class="widget-icon"> <i class="fa fa-list-alt"></i> </span>
                                <h2>Petunjuk Pengisian</h2>

                                <!-- <div class="widget-toolbar hidden-phone">
                                    <div class="smart-form">
                                        <label class="checkbox">
                                            <input type="checkbox" name="checkbox">
                                            <i></i>Add Padding</label>
                                    </div>
                                </div> -->

                            </header>

                            <!-- widget div-->
                            <div>

                                <!-- widget edit box -->
                                <div class="jarviswidget-editbox">
                                    <!-- This area used as dropdown edit box -->

                                </div>
                                <!-- end widget edit box -->

                                <!-- widget content -->
                                <div class="widget-body no-padding">

                                    <div class="panel-group smart-accordion-default" id="accordion-2">
                                        <div class="panel panel-default">
                                            <div class="panel-heading">
                                                <h4 class="panel-title"><a data-toggle="collapse" data-parent="#accordion-2" href="#collapseOne-1" class="collapsed"> <i class="fa fa-fw fa-plus-circle txt-color-green"></i> <i class="fa fa-fw fa-minus-circle txt-color-red"></i> 
                                                    Fungsi Berita</a></h4>
                                            </div>
                                            <div id="collapseOne-1" class="panel-collapse collapse">    <!-- tambah in setelah collapse dan class="collapsed" di atas (H4)--> 
                                                <div class="panel-body">

                                                        Untuk menampilkan berita seputar kegiatan di instansi. Berita yang disajikan dapat dilihat juga oleh pengunjung website di instansi lain. <br>                                                         
                                                        Untuk menarik banyak pembaca di website Anda, atau agar jumlah pengunjung website Anda meningkat,                                                         
                                                        sangat disarankan untuk menyajikan berita dalam bentuk yang lengkap dan memiliki unsur-unsur (<b>5W+1H</b>) berikut: <br>
                                                        <ol>
                                                            <li>Apa yang terjadi atau apa yang diberitakan?</li>
                                                            <li>Siapa yang terlibat dalam berita atau siapa yang berbicara?</li>                                                                                                                        
                                                            <li>Mengapa kejadian, kegiatan, atau peristiwa tersebut dapat terjadi?</li>                                                            
                                                            <li>Kapan kejadian, kegiatan, atau peristiwanya?</li>                                                            
                                                            <li>Dimana kejadian, kegiatan, atau peristiwanya?</li>
                                                            <li>Bagaimana deskripsi kejadian, kegiatan atau peristiwa yang telah dijelaskan sebelumnya?</li>                                                                                                                    
                                                        </ol>

                                                                                            
                                                        <!-- get link
                                                        https://docs.google.com/document/d/1_ln9u-uQsMY2Y_BvFI3ahWDihhJMlvLhnyupqOtXefQ/edit?usp=sharing
                                                        
                                                        https://lh3.googleusercontent.com/d/1_ln9u-uQsMY2Y_BvFI3ahWDihhJMlvLhnyupqOtXefQ

                                                        https://drive.google.com/file/d/1zicoOR-Ms8ANLJU5WzPcwPZPqBE_QQmt/view?usp=sharing -->
                                                        
                                                        <!-- <h3>Contoh Embed:</h3> -->
                                                </div>
                                            </div>
                                        </div>

                                        <div class="panel panel-default">
                                            <div class="panel-heading">
                                                <h4 class="panel-title"><a data-toggle="collapse" data-parent="#accordion-2" href="#collapseTwo-1" class="collapsed"> <i class="fa fa-fw fa-plus-circle txt-color-green"></i> <i class="fa fa-fw fa-minus-circle txt-color-red"></i> 
                                                    Cara Mengisi Berita</a></h4>
                                            </div>
                                            <div id="collapseTwo-1" class="panel-collapse collapse">    <!-- tambah in setelah collapse dan class="collapsed" di atas (H4)--> 
                                                <div class="panel-body">

                                                        <ol>
                                                            <li> Klik tombol <b>Tambah Data</b> / <b>Edit Data</b>. </li>
                                                            <li> Input judul berita. </li>
                                                            <li> Input Isi Berita.</li>
                                                            <li> Editor di inputan isi berita dapat menampung data seperti :
                                                                <ul>
                                                                    <li>Teks / tulisan</li>
                                                                    <li>Gambar, <a data-toggle="collapse" data-parent="#accordion-2" href="#collapseUploadViaEditor"><b>Upload Gambar Via Editor</b></a></li>                                                                                                                                         
                                                                    <li>Preview File Office, <a data-toggle="collapse" data-parent="#accordion-2" href="#collapsePreviewDokumen"><b>Preview Via Dokumen</b></a></li>
                                                                    <li>Preview File Office dari Google Drive, <a data-toggle="collapse" data-parent="#accordion-2" href="#collapsePreviewGambar"><b>Preview Via Google Drive</b></a></li>


                                                                    <!-- <li><a data-toggle="collapse" data-parent="#accordion-2" href="#collapsePreviewDokumen"><b>Preview Via Dokumen</b></a> (pdf, doc, docx, xls, xlsx, ppt, pptx, png, jpg, dll)</li> -->
                                                                    <!-- <li><a data-toggle="collapse" data-parent="#accordion-2" href="#collapsePreviewGambar"><b>Preview Via Google Drive</b></a> (pdf, doc, docx, xls, xlsx, ppt, pptx, png, jpg, dll)</li> -->
                                                                    <li>Buat Link ke <a data-toggle="collapse" data-parent="#accordion-2" href="#collapseLinkKeWebsiteLain"><b>Website Lain.</b></a> </li>
                                                                </ul>
                                                            </li>



                                                            <li> Input kategori berita. </li> 
                                                            <li> Input tags berita. Data tags ini dapat dipilih lebih dari satu, dengan cara tekan <b>Ctrl + Klik Tag</b> yang sesuai</li> 
                                                            <li> Input status Berita, <b>Publish</b> atau <b>Draft</b>. </li> 
                                                            <li> Foto untuk slide show. Foto ini akan tampil di halaman depan website. </li> 
                                                                <ul>
                                                                    <li>Foto berjumlah 3 buah, paling tidak ada 1 foto terisi agar memudahkan mengenali berita di halaman depan website.</li>
                                                                    <li><a data-toggle="collapse" data-parent="#accordion-2" href="#collapseCropFoto"><b>Crop Foto</b></a> dengan dimensi <b>720 x 540 Pixel</b>. </li>                                                                                                                                                                                                                                                                                                                                        
                                                                </ul>

                                                            

                                                            <li> Klik tombol <b>Simpan</b></li>
                                                            <li> Refresh tampilan website Anda. </li>                                                        
                                                            

                                                        </ol>
                          

                                                        <br>
                                                        Catatan :<br>
                                                        <b>File Office</b> yang dapat di tampilkan preview nya adalah: pdf, doc, docx, xls, xlsx, ppt, pptx, png, jpg, dll.



                                                </div>
                                            </div>
                                        </div>


                                        

                                        <div class="panel panel-default">
                                            <div class="panel-heading">
                                                <h4 class="panel-title"><a data-toggle="collapse" data-parent="#accordion-2" href="#collapseUploadViaEditor" class="collapsed"> <i class="fa fa-fw fa-plus-circle txt-color-green"></i> <i class="fa fa-fw fa-minus-circle txt-color-red"></i> 
                                                    Cara Upload Gambar Via Editor</a></h4>
                                            </div>
                                            <div id="collapseUploadViaEditor" class="panel-collapse collapse">    <!-- tambah in setelah collapse dan class="collapsed" di atas (H4)--> 
                                                <div class="panel-body">
                                        
                                                    {% include 'account/snippets/cara-upload-gambar-via-editor.html' %}
                                        
                                                    <hr>
                                                    <a data-toggle="collapse" data-parent="#accordion-2" href="#collapseTwo-1"><b>&#60;&#60; kembali</b></a>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="panel panel-default">
                                            <div class="panel-heading">
                                                <h4 class="panel-title"><a data-toggle="collapse" data-parent="#accordion-2" href="#collapsePreviewDokumen" class="collapsed"> <i class="fa fa-fw fa-plus-circle txt-color-green"></i> <i class="fa fa-fw fa-minus-circle txt-color-red"></i> 
                                                    Cara Preview Via Dokumen</a></h4>
                                            </div>
                                            <div id="collapsePreviewDokumen" class="panel-collapse collapse">    <!-- tambah in setelah collapse dan class="collapsed" di atas (H4)--> 
                                                <div class="panel-body">
                                        
                                                    {% include 'account/snippets/cara-buat-preview-via-menu-dokumen.html' %}
                                        
                                                    <hr>
                                                    <a data-toggle="collapse" data-parent="#accordion-2" href="#collapseTwo-1"><b>&#60;&#60; kembali</b></a>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="panel panel-default">
                                            <div class="panel-heading">
                                                <h4 class="panel-title"><a data-toggle="collapse" data-parent="#accordion-2" href="#collapsePreviewGambar" class="collapsed"> <i class="fa fa-fw fa-plus-circle txt-color-green"></i> <i class="fa fa-fw fa-minus-circle txt-color-red"></i> 
                                                    Cara Preview Via Google Drive</a></h4>
                                            </div>
                                            <div id="collapsePreviewGambar" class="panel-collapse collapse">    <!-- tambah in setelah collapse dan class="collapsed" di atas (H4)--> 
                                                <div class="panel-body">
                                        
                                                    {% include 'account/snippets/cara-buat-preview-via-google-drive.html' %}

                                                    <hr>
                                                    <a data-toggle="collapse" data-parent="#accordion-2" href="#collapseTwo-1"><b>&#60;&#60; kembali</b></a>
                                        
                                                </div>
                                            </div>
                                        </div>                                        


                                        <div class="panel panel-default">
                                            <div class="panel-heading">
                                                <h4 class="panel-title"><a data-toggle="collapse" data-parent="#accordion-2" href="#collapseCopyURLDokumen" class="collapsed"> <i class="fa fa-fw fa-plus-circle txt-color-green"></i> <i class="fa fa-fw fa-minus-circle txt-color-red"></i> 
                                                    Cara Copy URL Dokumen</a></h4>
                                            </div>
                                            <div id="collapseCopyURLDokumen" class="panel-collapse collapse">   
                                                <div class="panel-body">
                                        
                                                    {% include 'account/snippets/cara-copy-url-dokumen.html' %}
                                        

                                                    <hr>
                                                    <a data-toggle="collapse" data-parent="#accordion-2" href="#collapsePreviewDokumen"><b>&#60;&#60; kembali</b></a>
                                                </div>
                                            </div>
                                        </div>                                        

                                        <div class="panel panel-default">
                                            <div class="panel-heading">
                                                <h4 class="panel-title"><a data-toggle="collapse" data-parent="#accordion-2" href="#collapseLinkKeWebsiteLain" class="collapsed"> <i class="fa fa-fw fa-plus-circle txt-color-green"></i> <i class="fa fa-fw fa-minus-circle txt-color-red"></i> 
                                                    Cara Buat Link Ke Website Lain</a></h4>
                                            </div>
                                            <div id="collapseLinkKeWebsiteLain" class="panel-collapse collapse">   
                                                <div class="panel-body">
                                        
                                                    {% include 'account/snippets/cara-buat-link-ke-website-lain.html' %}
                                        
                                                    <hr>
                                                    <a data-toggle="collapse" data-parent="#accordion-2" href="#collapseTwo-1"><b>&#60;&#60; kembali</b></a>
                                                </div>
                                            </div>
                                        </div>


                                        <div class="panel panel-default">
                                            <div class="panel-heading">
                                                <h4 class="panel-title"><a data-toggle="collapse" data-parent="#accordion-2" href="#collapseCopyFileIDGoogleDrive" class="collapsed"> <i class="fa fa-fw fa-plus-circle txt-color-green"></i> <i class="fa fa-fw fa-minus-circle txt-color-red"></i> 
                                                    Cara Copy FILE_ID Google Drive</a></h4>
                                            </div>
                                            <div id="collapseCopyFileIDGoogleDrive" class="panel-collapse collapse">   
                                                <div class="panel-body">
                                        
                                                    {% include 'account/snippets/cara-copy-file-id-google-drive.html' %}
                                        

                                                    <hr>
                                                    <a data-toggle="collapse" data-parent="#accordion-2" href="#collapsePreviewGambar"><b>&#60;&#60; kembali</b></a>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="panel panel-default">
                                            <div class="panel-heading">
                                                <h4 class="panel-title"><a data-toggle="collapse" data-parent="#accordion-2" href="#collapseCropFoto" class="collapsed"> <i class="fa fa-fw fa-plus-circle txt-color-green"></i> <i class="fa fa-fw fa-minus-circle txt-color-red"></i> 
                                                    Cara Crop Foto</a></h4>
                                            </div>
                                            <div id="collapseCropFoto" class="panel-collapse collapse">    <!-- tambah in setelah collapse dan class="collapsed" di atas (H4)--> 
                                                <div class="panel-body">
                                        
                                                    {% include 'account/snippets/cara-crop-photo.html' %}
                                        

                                                    <hr>
                                                    <a data-toggle="collapse" data-parent="#accordion-2" href="#collapseTwo-1"><b>&#60;&#60; kembali</b></a>
                                                </div>
                                            </div>
                                        </div>
                                
                                    </div>

                                </div>
                                <!-- end widget content -->

                            </div>
                            <!-- end widget div -->

                        </div>
                        <!-- end widget -->

                    </article>
                    <!-- WIDGET END -->     

                    
                    <!-- NEW WIDGET START -->
                    <article class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                        
                        <!-- Widget ID (each widget will need unique ID)-->
                        <div class="jarviswidget" id="wid-id-0">
                            <!-- widget options:
                                usage: <div class="jarviswidget" id="wid-id-0" data-widget-editbutton="false">
                                
                                data-widget-colorbutton="false"	
                                data-widget-editbutton="false"
                                data-widget-togglebutton="false"
                                data-widget-deletebutton="false"
                                data-widget-fullscreenbutton="false" 
                                data-widget-custombutton="false"
                                data-widget-collapsed="true" 
                                data-widget-sortable="false"
                                
                            -->
                            <header>
                                {% for i in menu_aktif %}
                                    <span class="widget-icon"> 
                                    {% if i.icon != '' %}
                                        <i class="fa-fw fa fa-{{i.icon}}"></i> 
                                    {% else %}
                                        <i class="fa-fw fa fa-home"></i> 
                                    {% endif %}
                                    </span>

                                    <h2>{{i.nama}}</h2>
                                    
                                {% endfor %}				
                                
                            </header>
            
                            <!-- widget div-->
                            <div>
                                
                                <!-- widget edit box -->
                                <div class="jarviswidget-editbox">
                                    <!-- This area used as dropdown edit box -->
                                    <input class="form-control" type="text">	
                                </div>
                                <!-- end widget edit box -->
                                
                                <!-- widget content -->
                                <div class="widget-body">
                                    {{ formset_img.management_data }}    
                                    {% if formset_img.non_form_errors %}
                                        <div class="alert alertdanger">{{formset_img.non_form_errors}}</div>
                                    {% endif %}
                                    
                                    {% if form.errors %}
                                        {% for field in form %}
                                            {% for error in field.errors %}
                                                <div class="alert alert-danger">
                                                    <strong>{{ field.label }}</strong><span>{{ error|escape }}</strong>
                                                </div>
                                            {% endfor %}
                                        {% endfor %}
                                        {% for error in form.non_field_errors %}
                                            <div class="alert alert-danger">
                                                <strong>{{ error|escape }}</strong>
                                            </div>
                                        {% endfor %}
                                    {% endif %}

                                    <!-- {% comment %} tanggal = {{tanggal}} <br>
                                    tanggal = {{tanggal|naturaltime}} {% endcomment %} -->
                                    {% if mode == '' %}
                                        <table id="datatable_tabletools" class="table table-striped table-bordered table-hover" width="100%">
                                            <thead>
                                                <tr>
                                                    <th>ID</th>                                                                                                        
                                                    <th data-hide="expand">Judul</th>
                                                    <th data-hide="phone,tablet">Isi Berita</th>                                                    
                                                    <th data-hide="phone,tablet">Kategori</th>                                                    
                                                    <th data-hide="phone,tablet">Foto Utama</th>                                                    
                                                    <th data-hide="phone,tablet">Jumlah Foto</th>                         
                                                    <th data-hide="phone,tablet">Satus</th>                                                    
                                                    <th data-hide="phone,tablet">Last Update</th>                                                
                                                    <th>Action</th>
                                                </tr>
                                            </thead>
                                            <tbody></tbody>
                                        </table>
                                    {% elif mode|lower == 'add' or mode|lower == 'edit' %}
                                        <form class="form-horizontal" method="POST" enctype="multipart/form-data"> 
                                            {% csrf_token %}
                                            {{ form.media }}
                                            

                                            <fieldset>        
                                                <legend>Berita</legend>                                              
                                                <div class="form-group">
                                                    <label class="control-label col-md-1">{{form.judul.label_tag}}</label>
                                                    <div class="col-md-11">
                                                        <div class="row">
                                                            <div class="col-sm-12">                                
                                                                <div class="input-group">
                                                                    <span class="input-group-addon"><i class="icon-prepend fa fa-user"></i></span>																	
                                                                    {{form.judul}}                                    
                                                                </div>
                                                            </div>                            
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <div class="form-group">													
                                                    <label class="control-label col-md-1" for="prepend">{{form.isi_berita.label_tag}}</label>
                                                    <div class="col-md-11">
                                                        <div class="row">
                                                            <div class="col-sm-12">                                
                                                                <!-- <div class="input-group"> -->
                                                                    <!--<span class="input-group-addon"><i class="icon-prepend fa fa-map-marker"></i></span> -->						
                                                                    {{form.isi_berita}}

                                                                    <!-- <br>
                                                                    <button class="btn btn-secondary" type="button" id="insert_image_id" value="Insert Image" 
                                                                        name="insert_image" onClick="do_insert_image();">
                                                                        <i class="icon-prepend fa fa-ban"></i> Insert Image                                        
                                                                    </button> -->

                                                                <!-- </div>                               -->
                                                            </div>                              
                                                        </div>
                                                    </div>                        
                                                </div> 

                                                <div class="form-group">													
                                                    <label class="control-label col-md-1" for="prepend">{{form.kategori.label_tag}}</label>
                                                    <div class="col-md-11">
                                                        <div class="row">
                                                            <div class="col-sm-12">                                
                                                                <div class="input-group">
                                                                    <span class="input-group-addon"><i class="icon-prepend fa fa-map-marker"></i></span>						<!--onclick="init_select2_provinsi()"-->											
                                                                    {{form.kategori}}
                                                                </div>                              
                                                            </div>                              
                                                        </div>
                                                    </div>                        
                                                </div> 

                                                <div class="form-group">													
                                                    <label class="control-label col-md-1" for="prepend">{{form.tags.label_tag}}</label>
                                                    <div class="col-md-11">
                                                        <div class="row">
                                                            <div class="col-sm-12">                                
                                                                <div class="input-group">
                                                                    <span class="input-group-addon"><i class="icon-prepend fa fa-map-marker"></i></span>						
                                                                    {{form.tags}}
                                                                </div>                              
                                                            </div>                              
                                                        </div>
                                                    </div>                        
                                                </div> 

                                                <!--<div class="form-group">													
                                                    <label class="control-label col-md-1" for="prepend">{{form.tags.label_tag}}</label>
                                                    <div class="col-md-11">
                                                        <div class="row">
                                                            <div class="col-sm-10"> 
                                                                {{form.tags}}
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>-->

                                                <div class="form-group">													
                                                    <label class="control-label col-md-1" for="prepend">{{form.status.label_tag}}</label>
                                                    <div class="col-md-11">
                                                        <div class="row">
                                                            <div class="col-sm-12">                                
                                                                <div class="input-group">
                                                                    <span class="input-group-addon"><i class="icon-prepend fa fa-map-marker"></i></span>						<!--onclick="init_select2_provinsi()"-->											
                                                                    {{form.status}}
                                                                </div>                              
                                                            </div>                              
                                                        </div>
                                                    </div>                        
                                                </div> 

                                                <legend>Foto </legend> <!--max 3 dengan ukuran 1000 x 840px-->
                                                
                                                {{ formset_img.as_p}}                                                                                                
                                            </fieldset>

                                            <div class="form-actions">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        
                                                        <button class="btn btn-primary" type="submit" value="save" name="proses">                                                                								
                                                            <i class="icon-prepend fa fa-save"></i> simpan
                                                        </button>
                                                        <!--<button class="btn btn-success" type="submit" value="save_add_new" name="proses">                                                                								
                                                            <i class="icon-prepend fa fa-save"></i> simpan & input baru
                                                        </button>							-->
                                                        <button class="btn btn-secondary" type="submit" id="cancel-btn" value="cancel" name="proses">
                                                            <i class="icon-prepend fa fa-ban"></i> batal                                                           
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>  
                                    {% endif %}
            
                                </div>
                                <!-- end widget content -->
                                
                            </div>
                            <!-- end widget div -->
                            
                        </div>
                        <!-- end widget -->
            
                    </article>
                    <!-- WIDGET END -->
                    
                </div>
            
                <!-- end row -->
            
                <!-- row -->
            
                <div class="row">
            
                    <!-- a blank row to get started -->
                    <div class="col-sm-12">
                        <!-- your contents here -->
                    </div>
                        
                </div>
            
                <!-- end row -->
            
            </section>
            <!-- end widget grid -->

        </div>
        <!-- END MAIN CONTENT -->

    </div>
    <!-- END MAIN PANEL -->

    <!-- MODAL TO CROP THE IMAGE -->
    {% include "account/inc-cropping-form.html" %}         
{% endblock %}

<!--Beda sedikit cara nya karena ada parameter baru yaitu pPhotoID
    Proses edit dan delete per foto, jadi tidak bisa sekaligus
-->
<!-- di luar doc ready -->
{% block java-script %}
    // deklarasi image cropping    
    var ww, hh;

    // Mulai kini ukuran dibagi 2 agar di capai ukuran file optimal, dan di OD di bawah 300kb
    ww =  720; // 360; // 240; // 180; // 683; // 720; 
    hh =  540; // 270; // 180; // 135; // 514; // 540;

    //ww = 720; 
    //hh = 540;
    
    //$(function () {
    //});    
    
    //function do_insert_image() {        
    //    var imgHtml = CKEDITOR.dom.element.createFromHtml("<img src='sdsds' alt='' align='right'/>");
    //    //CKEDITOR.instances.id_isi_berita.insertHtml(imgHtml);
    //    console.log(CKEDITOR);
    //    CKEDITOR.instances.id_isi_berita.insertHtml( 
    //        '<div class="embed-responsive embed-responsive-1by1">' +
    //            '<iframe class="embed-responsive-item" frameborder="0" ' +
    //                'src="https://drive.google.com/file/d/1bk4Wka1nKbpZAOpUi9pwAKNLw48o4uMk/preview">' +
    //            '</iframe>' +
    //        '</div>'
    //    );
    //    alert('Image Inserted');
    //};

{% endblock %}

{% block jquery-doc-ready %}
    var breakpointDefinition = {
        tablet : 1024,
        phone : 480 
    };    

    var responsiveHelper_datatable_tabletools = undefined;
    $('#datatable_tabletools').dataTable({
        //"processing": true,
        "deferRender": true,    // for lazy load data (load per page)
        ajax: {            
            //"processing": true,
            "url": "{% url 'berita_ajax' %}",
            "dataSrc": "",            
        },
        columns:[
            {data: "id"},            
            //{data: "photo__id"},
            {data: "judul"},
            {data: "isi_berita", render: $.fn.dataTable.render.text()},            
            {data: "kategori__nama"}, 
            {data: "foto"},             
            {data: "foto_count"},             
            {data: "status"},            
            {data: "updated_at"},                   
            {render: function ( data, type, row ) {
                //console.log('data');
                //console.log(row);
                //foreach i in row {
                //    console.log(i.updated_at);
                //}

                return "<div class='toolbar text-right'><button onclick='do_edit(" + row.id + ");' class='btn btn-success btn-xs' title='Edit Data'> "+
                       "    <i class='fa fa-edit'></i> "+                                                           
                       "</button> "+
                       "<button onclick='do_delete(" + row.id + ", \"" + row.judul + "\"" + ");' class='btn btn-danger btn-xs' title='Hapus Data'> "+
                       "    <i class='fa fa-eraser'></i> "+                                                           
                       "</button>"+
                       "</div>";
                }
            },      
        ],     
        "order": [[ 0, "desc" ]],   
        "columnDefs": [
            {
                "targets": [ 0 ],
                "visible": false,
                "searchable": false
            },  

            {
                "targets": [ 4 ],
                
                render: function(data) {
                    if (data != null) {
                        //console.log( data);
                        return '<img src="/media/' + data + '" class="img-thumbnail">'
                    }
                    else return 'Tdk ada'
                }
            
            },    
            
            {
                // tampilkan hiperlink di kolom pertama (agar dapat melakukan editing dengan klik field 1)
                "targets": [ 1 ],
                
                render: function(data, type, row) {                            
                    return  "<a href='javascript:void(0);' onclick='do_edit(" + row.id + ");' title='Edit Data'>"+ 
                            "<strong>" + data + "</strong>" +
                            "</a>";                                
                }                    
            },
            { 
                "targets": [ 8 ], 
                "width": "60px",
                "sortable": false,
                "searchable": false,  
            },

            //{   "targets": [ 3 ], render:function(data){
                    //return moment(data).format('MMMM Do YYYY');
            //        return data
            //    }
            //}, bisa di lakukan di view (from django.contrib.humanize.templatetags.humanize import naturalday)
        ],        
        
        "sDom": "<'dt-toolbar text-right'<'col-xs-12 col-sm-6 hidden-xs'f><'toolbar'>r>"+                
                "t"+
                "<'dt-toolbar-footer'<'col-sm-6 col-xs-12 hidden-xs'i><'col-sm-6 col-xs-12'p>>",      
        "autoWidth" : true,
        "oLanguage": {
            "sSearch": '<span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span>'
        },		            
        "preDrawCallback" : function() {
            // Initialize the responsive datatables helper once.
            if (!responsiveHelper_datatable_tabletools) {
                responsiveHelper_datatable_tabletools = new ResponsiveDatatablesHelper($('#datatable_tabletools'), breakpointDefinition);
            }
        },
        "rowCallback" : function(nRow) {
            responsiveHelper_datatable_tabletools.createExpandIcon(nRow);
        },
        "drawCallback" : function(oSettings) {
            responsiveHelper_datatable_tabletools.respond();
        }
    });

    // document ready
    $("div.toolbar").html(
        "<a class='btn btn-primary btn-md' href='javascript:void(0);' onclick='do_add(\"add\");' title='Tambah Data'> " +
        "<i class='fa fa-plus'></i></a>");

    $("#cancel-btn").click(function (event) {
        var lanjut = false;

        {% if mode == 'add' %}
            if (confirm("Batal input data?")) { 
                console.log('delete first!');
                console.log(file_path[0]);
                lanjut = true;
                //event.preventDefault();        
                //window.history.back(); 
            }       
        {% elif mode == 'edit' %}
            if (confirm("Batal edit data?")) {
                console.log('delete first!');
                console.log(file_path[0]);
                lanjut = true;

                //event.preventDefault();          
                //window.history.back(); 
            }   
        {% endif %}  
        
        if (lanjut) {
            var formData = new FormData();
            formData.append('file_path_0', file_path[0]);
            formData.append('file_path_1', file_path[1]);
            formData.append('file_path_2', file_path[2]);
            
            //let tmp = file_path[0];
            //console.log(tmp);
            //tmp = tmp.replaceAll('/', '%2F'); 2E = .; 2D = -
            //tmp = tmp.replaceAll('-', '_');

            //tmp = tmp.replaceAll('/', '%2F');
            //tmp = tmp.replaceAll('-', '%2D');
            //tmp = tmp.replaceAll('.', '%2E');
            //console.log(tmp);

            //$.ajax({
            //    url: "/delete-photo/", 
            //    success: function(result){                    
            //        window.location.href = '/dashboard/berita/';
            //    }
            //}); 
            let csrftoken = $('input[name="csrfmiddlewaretoken"]').val();
            
            $.ajax('/dashboard/delete-photo/', {
                method: "POST",
                data: formData,
                processData: false,
                contentType: false,
                headers:{'X-CSRFToken':csrftoken},

                success: function (response) {
                    console.log('response = ');
                    console.log(response);      

                    // Jika ini tidak ada, maka akan di posting dan di anggap form submit, sehinggga proses simpan dijalankna lagi    
                    event.preventDefault();             
                    window.location.href = '/dashboard/berita/';
                },
                error: function () {
                    console.log('Delete error');
                }
            });
        };
    });
    
    //CKEDITOR.replace( 'isi_berita', { height: '380px', startupFocus : true} );
    //var editor = CKEDITOR.replace( 'isi_berita' , {
        //filebrowserBrowseUrl: 'https://ckeditor.com/apps/ckfinder/3.4.5/ckfinder.html?type=Images&CKEditor=editor1&CKEditorFuncNum=0&langCode=en',
    //    filebrowserUploadUrl: 'https://ckeditor.com/apps/ckfinder/3.4.5/ckfinder.html?type=Images&CKEditor=editor1&CKEditorFuncNum=0&langCode=en', //'/ckfinder/core/connector/php/connector.php?command=QuickUpload&type=Files'
    //    } 
    // );
    //CKFinder.setupCKEditor( editor ); //, null, { type: 'Files', currentFolder: '/media/' }

    //CKFinder.widget( 'ckfinder-widget', {
    //    width: '100%',
    //    height: 500,
    //   plugins: [
    //        // The path must be relative to the location of the ckfinder.js file.
    //        '../samples/plugins/StatusBarInfo/StatusBarInfo'
    //    ]
    //} ); 

    {% for message in messages %}                                        		
        $.smallBox({
            title : "<i class='fa fa-desktop'></i> &nbsp;&nbsp; {{message|safe}}",
            content : "<i class='fa fa-clock-o'></i> <i>Berita</i>",
            color : "#296191",
            iconSmall : "fa fa-thumbs-up bounce animated",
            timeout : 4000
        });
    {% endfor %}
{% endblock %}

{% block related-plugin %}        
    <script src="{% static 'account/js/plugin/datatables/jquery.dataTables.min.js' %}"></script>
	<script src="{% static 'account/js/plugin/datatables/dataTables.colVis.min.js' %}"></script>
	<script src="{% static 'account/js/plugin/datatables/dataTables.tableTools.min.js' %}"></script>
	<script src="{% static 'account/js/plugin/datatables/dataTables.bootstrap.min.js' %}"></script>
	<script src="{% static 'account/js/plugin/datatable-responsive/datatables.responsive.min.js' %}"></script>

    <!--<script src="{% static 'account/js/plugin/ckeditor/ckeditor.js' %}"></script>
    <script src="{% static 'account/js/plugin/ckeditor/ckfinder.js' %}"></script>-->
    <!--<script src="https://cdn.ckeditor.com/4.16.1/standard-all/ckeditor.js"></script> -->

    <!-- <script src="{% static 'ckeditor/ckeditor-init.js' %}"></script>
    <script src="{% static 'ckeditor/ckeditor/ckeditor.js' %}"></script> -->
    <!-- <script src="https://cdn.ckeditor.com/ckeditor5/38.0.1/classic/ckeditor.js"></script> -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-Fy6S3B9q64WdZWQUiU+q4/2Lc9npb8tCaSX9FK7E8HnRr0Jz8D6OP9dO5Vg3Q9ct" crossorigin="anonymous"></script> -->
  

{% endblock %}