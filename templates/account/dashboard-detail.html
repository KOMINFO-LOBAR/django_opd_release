{% extends "account/base-dashboard.html" %} {% load static %} {% block content %} <div id=main  role=main > <div id=ribbon > <span class=ribbon-button-alignment > <span id=refresh  class="btn btn-ribbon" data-action=resetWidgets  data-title=refresh  rel=tooltip  data-placement=bottom  data-original-title="<i class='text-warning fa fa-warning'></i> Warning! This will reset all your widget settings." data-html="true"> <i class="fa fa-refresh"></i> </span> </span> <ol class=breadcrumb > <li>Selamat Datang, {{ user.username|default:'Guest'|title }} - [ {{namaOPD}} ] </ol> </div> <div id=content > <div class=row > <div class="col-xs-12 col-sm-7 col-md-7 col-lg-4"> <h1 class="page-title txt-color-blueDark"> {% for i in menu_aktif %} {% if i.icon != '' %} <i class="fa-fw fa fa-{{i.icon}}"></i> {% else %} <i class="fa-fw fa fa-home"></i> {% endif %} {{i.nama}} <span>> Grid </span> {% endfor %} </h1> </div> &nbsp; <div class="col-xs-12 col-sm-5 col-md-5 col-lg-8"> <select name=category_id  class=select2_category  style="width: 100%; "> </select> </div> &nbsp; </div> <section id=widget-grid  class=""> <div class=row > <article class="col-xs-12 col-sm-12 col-md-12 col-lg-12"> <div class=jarviswidget  id=wid-id-0  data-widget-colorbutton=false  data-widget-editbutton=false  data-widget-togglebutton=false  data-widget-deletebutton=false  data-widget-fullscreenbutton=false  data-widget-custombutton=false  data-widget-collapsed=false  data-widget-sortable=false > <header> {% for i in menu_aktif %} <span class=widget-icon > {% if i.icon != '' %} <i class="fa-fw fa fa-{{i.icon}}"></i> {% else %} <i class="fa-fw fa fa-home"></i> {% endif %} </span> <h2>Kontribusi Pada Website</h2> {% endfor %} </header> <div> <div class=jarviswidget-editbox > <input class=form-control  type=text > </div> <div class=widget-body > <div id=id_kontribusi_kuantitas ></div> <hr> <div id=id_kontribusi_kualitas ></div> </div> </div> </div> </article> </div> </section> <section id=widget-grid  class=""> <div class=row > <article class="col-xs-12 col-sm-12 col-md-12 col-lg-12"> <div class=jarviswidget  id=wid-id-0  data-widget-colorbutton=false  data-widget-editbutton=false  data-widget-togglebutton=false  data-widget-deletebutton=false  data-widget-fullscreenbutton=false  data-widget-custombutton=false  data-widget-collapsed=false  data-widget-sortable=false > <header> {% for i in menu_aktif %} <span class=widget-icon > {% if i.icon != '' %} <i class="fa-fw fa fa-{{i.icon}}"></i> {% else %} <i class="fa-fw fa fa-home"></i> {% endif %} </span> <h2>Kontribusi Pada Website [Tabel]</h2> {% endfor %} </header> <div> <div class=jarviswidget-editbox > <input class=form-control  type=text > </div> <div class=widget-body > <table id=id_kontribusi_kuantitas_table  class="table table-striped table-bordered table-hover" width="100%"> <thead> <tr> <th>ID <th data-hide=expand >Instansi Berkontribusi Secara Kuantitas <th data-hide="phone,tablet">Berita <th data-hide="phone,tablet">Pengumuman <th data-hide="phone,tablet">Artikel <th data-hide="phone,tablet">Jumlah </table> <hr> <table id=id_kontribusi_kualitas_table  class="table table-striped table-bordered table-hover" width="100%"> <thead> <tr> <th>ID <th data-hide=expand >Instansi dengan Kontribusi Berkualitas <th data-hide="phone,tablet">Berita [100 kata] <th data-hide="phone,tablet">Pengumuman [50 kata] <th data-hide="phone,tablet">Artikel [100 kata] <th data-hide="phone,tablet">Jumlah </table> </div> </div> </div> </article> </div> </section> <section id=widget-grid  class=""> <div class=row > <article class="col-xs-12 col-sm-12 col-md-12 col-lg-12"> <div class=jarviswidget  id=wid-id-0  data-widget-colorbutton=false  data-widget-editbutton=false  data-widget-togglebutton=false  data-widget-deletebutton=false  data-widget-fullscreenbutton=false  data-widget-custombutton=false  data-widget-collapsed=false  data-widget-sortable=false > <header> {% for i in menu_aktif %} <span class=widget-icon > {% if i.icon != '' %} <i class="fa-fw fa fa-{{i.icon}}"></i> {% else %} <i class="fa-fw fa fa-home"></i> {% endif %} </span> <h2>Keterisian Menu Website</h2> {% endfor %} </header> <div> <div class=jarviswidget-editbox > <input class=form-control  type=text > </div> <div class=widget-body > <div id=pieChartKeterisianMenu ></div> </div> </div> </div> </article> </div> </section> <section id=widget-grid  class=""> <div class=row > <article class="col-xs-12 col-sm-12 col-md-12 col-lg-12"> <div class=jarviswidget  id=wid-id-2  data-widget-colorbutton=false  data-widget-editbutton=false  data-widget-togglebutton=false  data-widget-deletebutton=false  data-widget-fullscreenbutton=false  data-widget-custombutton=false  data-widget-collapsed=false  data-widget-sortable=false > <header> {% for i in menu_aktif %} <span class=widget-icon > {% if i.icon != '' %} <i class="fa-fw fa fa-{{i.icon}}"></i> {% else %} <i class="fa-fw fa fa-home"></i> {% endif %} </span> <h2>Detail Keterisian Menu Website</h2> {% endfor %} </header> <div> <div class=jarviswidget-editbox > <input class=form-control  type=text > </div> <div class=widget-body > <table id=datatable_tabletools  class="table table-striped table-bordered table-hover" width="100%"> <thead> <tr> <th>ID <th data-hide=expand >Alamat Website <th data-hide="phone,tablet">Menu Kosong <th data-hide="phone,tablet">Menu Terisi <th data-hide="phone,tablet">Total <th data-hide="phone,tablet">Keterisian (%) <th data-hide=expand >Grafik </table> </div> </div> </div> </article> </div> </section> <section id=widget-grid  class=""> <div class=row > <article class="col-xs-12 col-sm-12 col-md-12 col-lg-12"> <div class=jarviswidget  id=wid-id-3  data-widget-colorbutton=false  data-widget-editbutton=false  data-widget-togglebutton=false  data-widget-deletebutton=false  data-widget-fullscreenbutton=false  data-widget-custombutton=false  data-widget-collapsed=false  data-widget-sortable=false > <header> {% for i in menu_aktif %} <span class=widget-icon > {% if i.icon != '' %} <i class="fa-fw fa fa-{{i.icon}}"></i> {% else %} <i class="fa-fw fa fa-home"></i> {% endif %} </span> <h2>Menu Yang Sudah Terisi Tiap Instansi</h2> {% endfor %} </header> <div> <div class=jarviswidget-editbox > <input class=form-control  type=text > </div> <div class=widget-body > <div id=pieChart3 ></div> <table id=datatable_tabletools3  class="table table-striped table-bordered table-hover" width="100%"> <thead> <tr> <th>ID <th data-hide="phone,tablet">Parent Menu <th data-hide=expand >Nama Menu <th data-hide="phone,tablet">Judul Halaman Statis <th data-hide=expand >Sudah Terisi </table> </div> </div> </div> </article> </div> </section> </div> </div>45.28 {% endblock %} {% block jquery-doc-ready %} var bln = "{{mChartHit.bulan}}"; var line_hit_array = {{mChartHit.hit}}; var line_bln_array = bln.split(","); var bln = "{{mChartNews.bulan}}"; var news_berita_array = {{mChartNews.berita}}; var news_pengumuman_array = {{mChartNews.pengumuman}}; var news_artikel_array = {{mChartNews.artikel}}; var news_bln_array = bln.split(","); function kontribusi_kuantitas(kategori_id) { $.ajax({ url: "/dashboard/site_kontribusi_kuantitas_pie_chart_ajax/"+ kategori_id, type: "GET", success: function(result){ var pdata = []; var dict = {}; var drilldown = []; var drilldown_dic = {}; var drilldown_data = []; var tmp_label = ''; var tmp_data = 0; var arr_label = []; var grand_total = 0; for (let i=0; i<result.length; i++) { grand_total = grand_total + result[i]['total']; }; for (let i=0; i<result.length; i++) { tmp_label = result[i]['domain']; arr_label = tmp_label.split("."); if (grand_total == 0) tmp_data = 0; else tmp_data = (result[i]['total'] / grand_total * 100).toFixed(2); dict = {'name' : arr_label[0], 'y': parseFloat(tmp_data), 'drilldown': arr_label[0]}; pdata.push(dict); drilldown_dic = {'name': arr_label[0], 'id': arr_label[0], 'data': [['Berita', result[i]['berita']], ['Artikel', result[i]['artikel']], ['Pengumuman', result[i]['pengumuman']]]}; drilldown.push(drilldown_dic); }; highchart_productivity('id_kontribusi_kuantitas', pdata, drilldown, 'Kontribusi Secara Kuantitas', 'Kontribusi dengan jumlah posting terbanyak'); } }); }; function kontribusi_kualitas(kategori_id) { $.ajax({ url: "/dashboard/site_kontribusi_kualitas_pie_chart_ajax/"+ kategori_id, type: "GET", success: function(result){ var plabel = []; var pdata = []; var dict = {}; var drilldown = []; var drilldown_dic = {}; var drilldown_data = []; var tmp_label = ''; var tmp_data = 0; var arr_label = []; var grand_total = 0; for (let i=0; i<result.length; i++) { grand_total = grand_total + result[i]['total']; }; for (let i=0; i<result.length; i++) { tmp_label = result[i]['domain']; arr_label = tmp_label.split("."); if (grand_total == 0) tmp_data = 0; else tmp_data = (result[i]['total'] / grand_total * 100).toFixed(2); dict = {'name' : arr_label[0], 'y': parseFloat(tmp_data), 'drilldown': arr_label[0]}; pdata.push(dict); drilldown_dic = {'name': arr_label[0], 'id': arr_label[0], 'data': [['Berita', result[i]['berita']], ['Artikel', result[i]['artikel']], ['Pengumuman', result[i]['pengumuman']]]}; drilldown.push(drilldown_dic); console.log('DRILL DOWN DATA = '); console.log(JSON.stringify(drilldown)); }; highchart_productivity('id_kontribusi_kualitas', pdata, drilldown, 'Kontribusi Berkualitas', 'Memenuhi standar penulisan yang baik dan benar'); } }); }; function kontribusi_kuantitas_table(kategori_id) { console.log('kontribusi_kuantitas_table', kategori_id) var responsiveHelper_datatable_tabletools = undefined; $('#id_kontribusi_kuantitas_table').dataTable({ ajax: { "url": "/dashboard/site_kontribusi_kuantitas_table_ajax/"+ kategori_id, "dataSrc": "" }, columns:[ {data: "id"}, {data: "domain"}, {data: "berita"}, {data: "pengumuman"}, {data: "artikel"}, {data: "total"}, ], "order": [[ 5, "desc" ]], "aoColumnDefs": [ { "targets": [ 0 ], "visible": false, "searchable": false }, ], "sDom": "<'dt-toolbar text-right'<'col-xs-12 col-sm-6 hidden-xs'f><'toolbar'>r>"+ "t"+ "<'dt-toolbar-footer'<'col-sm-6 col-xs-12 hidden-xs'i><'col-sm-6 col-xs-12'p>>", "autoWidth" : true, "oLanguage": { "sSearch": '<span class=input-group-addon ><i class="glyphicon glyphicon-search"></i></span>' }, }); }; function kontribusi_kualitas_table(kategori_id) { var responsiveHelper_datatable_tabletools = undefined; $('#id_kontribusi_kualitas_table').dataTable({ ajax: { "url": "/dashboard/site_kontribusi_kualitas_table_ajax/"+ kategori_id, "dataSrc": "" }, columns:[ {data: "id"}, {data: "domain"}, {data: "berita"}, {data: "pengumuman"}, {data: "artikel"}, {data: "total"}, ], "order": [[ 5, "desc" ]], "aoColumnDefs": [ { "targets": [ 0 ], "visible": false, "searchable": false }, ], "sDom": "<'dt-toolbar text-right'<'col-xs-12 col-sm-6 hidden-xs'f><'toolbar'>r>"+ "t"+ "<'dt-toolbar-footer'<'col-sm-6 col-xs-12 hidden-xs'i><'col-sm-6 col-xs-12'p>>", "autoWidth" : true, "oLanguage": { "sSearch": '<span class=input-group-addon ><i class="glyphicon glyphicon-search"></i></span>' }, }); }; $.ajax({ url: "/dashboard/site_activity_pie_chart_ajax/", type: "GET", success: function(result){ console.log('dari keterisian menu'); console.log(result); var plabel = []; var pdata_total = []; var pdata_terisi = []; var pdata_persen = []; var pdata = []; var dict1 = {}; var dict2 = {}; var dict3 = {}; var tmp_label = ''; var arr_label = []; for (let i=0; i<result.length; i++) { tmp_label = result[i]['domain']; arr_label = tmp_label.split("."); plabel.push(arr_label[0]); pdata_total.push(result[i]['total_menu']); pdata_terisi.push(result[i]['terisi']); pdata_persen.push(parseFloat(result[i]['persen'].toFixed(2))); }; console.log('pdata total = '); console.log(pdata_total); dict1 = {'type' : 'column', 'name': 'Jumlah Menu', 'data': pdata_total}; dict2 = {'type' : 'column', 'name': 'Terisi', 'data': pdata_terisi}; dict3 = {'type' : 'column', 'name': 'Persen', 'data': pdata_persen}; pdata.push(dict1); pdata.push(dict2); pdata.push(dict3); highchart_keterisian_menu('pieChartKeterisianMenu', plabel, pdata); } }); var breakpointDefinition = { tablet : 1024, phone : 480 }; var responsiveHelper_datatable_tabletools = undefined; $('#datatable_tabletools').dataTable({ ajax: { "url": "/dashboard/site_activity_ajax/", "dataSrc": "" }, columns:[ {data: "id"}, {data: "domain"}, {render: function ( data, type, row ) { return (row.total_menu - row.terisi); } }, {data: "terisi"}, {data: "total_menu"}, {data: "persen", render: function ( data, type, row ) { return data.toFixed(2); } }, {render: function ( data, type, row ) { return ('<span class=spark >100,' + (row.persen).toFixed(2) + ',100</span>' + "<span class='label txt-color-blueDark'> " + (row.persen).toFixed(2) + " %</span>"); } }, ], "order": [[ 5, "desc" ]], "aoColumnDefs": [ { "targets": [ 0 ], "visible": false, "searchable": false }, ], "sDom": "<'dt-toolbar text-right'<'col-xs-12 col-sm-6 hidden-xs'f><'toolbar'>r>"+ "t"+ "<'dt-toolbar-footer'<'col-sm-6 col-xs-12 hidden-xs'i><'col-sm-6 col-xs-12'p>>", "autoWidth" : true, "oLanguage": { "sSearch": '<span class=input-group-addon ><i class="glyphicon glyphicon-search"></i></span>' }, "preDrawCallback" : function() { if (!responsiveHelper_datatable_tabletools) { responsiveHelper_datatable_tabletools = new ResponsiveDatatablesHelper($('#datatable_tabletools'), breakpointDefinition); } }, "rowCallback" : function(nRow) { responsiveHelper_datatable_tabletools.createExpandIcon(nRow); }, "drawCallback" : function(oSettings) { responsiveHelper_datatable_tabletools.respond(); $('.spark:not(:has(canvas))').sparkline('html', { type: 'bullet', rangeColor: ['#d3dafe','#a8b6ff','#7f94ff'], performanceColor: '#3030f0', targetColor: '#f03030', }); }, createdRow: function (row, data, index) { }, }); var siteid = {{siteid}}; console.log('siteid = '); console.log(siteid); var site_id_data = {{form_data|safe}}; console.log(site_id_data); var instansi_kategori_id_data = {{form_data_kategori|safe}}; console.log('instansi_kategori_id_data = '); console.log(instansi_kategori_id_data); var responsiveHelper_datatable_tabletools3 = undefined; $('#datatable_tabletools3').dataTable({ ajax: { "url": "/dashboard/site_activity_detail_ajax/" + siteid, "dataSrc": "" }, columns:[ {data: "id"}, {data: "parent"}, {data: "menu"}, {data: "judul"}, {data: "terisi", render: function ( data, type, row ) { if (data==1) { return '<i class="glyphicon glyphicon-ok"></i>'; } else { return null; } } }, ], "order": [[ 4, "desc" ]], "aoColumnDefs": [ { "targets": [ 0 ], "visible": false, "searchable": false }, ], "sDom": "<'dt-toolbar text-right'<'col-xs-12 col-sm-6 hidden-xs'f><'toolbar3'>r>"+ "t"+ "<'dt-toolbar-footer'<'col-sm-6 col-xs-12 hidden-xs'i><'col-sm-6 col-xs-12'p>>", "autoWidth" : true, "oLanguage": { "sSearch": '<span class=input-group-addon ><i class="glyphicon glyphicon-search"></i></span>' }, "preDrawCallback" : function() { if (!responsiveHelper_datatable_tabletools3) { responsiveHelper_datatable_tabletools3 = new ResponsiveDatatablesHelper($('#datatable_tabletools3'), breakpointDefinition); } }, "rowCallback" : function(nRow) { responsiveHelper_datatable_tabletools3.createExpandIcon(nRow); }, "drawCallback" : function(oSettings) { responsiveHelper_datatable_tabletools3.respond(); }, "fnInitComplete": function(oSettings, json) { }, }); $("div.toolbar3").html( '<div style="text-align: left;">' + '<select name=site_id  class=select2_site  style="width: 50%; ">' + '</select>' + '</div>' ); $('.select2_site').select2({ ajax: { url: '/dashboard/site_ajax/', delay: 250, dataType: 'json', data: function (params) { var query = { search: params.term, page: params.page || 1 }; return query; }, processResults: function (data, params) { params.page = params.page || 1; return { results: data.results, pagination: { more: (params.page * 10) < data.count_filtered } }; }, }, theme: 'bootstrap4', allowClear: true, }); $('.select2_site').on('select2:open', () => { this.querySelector('.select2-search__field').focus(); }); $('.select2_site').on('select2:select', function (e) { var data = e.params.data; site_id = data.id; $('#datatable_tabletools3').DataTable().ajax.url("/dashboard/site_activity_detail_ajax/" + site_id).load(); $.ajax({ url: "/dashboard/site_activity_detail_pie_chart_ajax/" + site_id, type: "GET", success: function(result){ console.log(result); var title = 'Keterisian Menu Pada Website "' + data.text + '"'; highchart_keterisian_detail(result, title); } }); }); $(".select2_site").select2("trigger", "select", { data : site_id_data }); $('.select2_category').select2({ ajax: { url: '/dashboard/instansi_kategori_ajax/', delay: 250, dataType: 'json', data: function (params) { var query = { search: params.term, page: params.page || 1 }; return query; }, processResults: function (data, params) { params.page = params.page || 1; return { results: data.results, pagination: { more: (params.page * 10) < data.count_filtered } }; }, }, theme: 'bootstrap4', allowClear: true, }); $('.select2_category').on('select2:open', () => { this.querySelector('.select2-search__field').focus(); }); var is_first_enter = true; $('.select2_category').on('select2:select', function (e) { var data = e.params.data; kategori_id = data.id; kontribusi_kualitas(kategori_id); kontribusi_kuantitas(kategori_id); if (!is_first_enter) { $('#id_kontribusi_kuantitas_table').DataTable().ajax.url("/dashboard/site_kontribusi_kuantitas_table_ajax/" + kategori_id).load(); $('#id_kontribusi_kualitas_table').DataTable().ajax.url("/dashboard/site_kontribusi_kualitas_table_ajax/" + kategori_id).load(); } else { is_first_enter = !is_first_enter kontribusi_kuantitas_table(kategori_id); kontribusi_kualitas_table(kategori_id); }; }); $(".select2_category").select2("trigger", "select", { data : instansi_kategori_id_data }); {% for message in messages %} $.smallBox({ title : "<i class='fa fa-desktop'></i> &nbsp;&nbsp; {{message|safe}}", content : "<i class='fa fa-link'></i> <i>Dashboard</i>", color : "#296191", iconSmall : "fa fa-thumbs-up bounce animated", timeout : 4000 }); {% endfor %} $("html,body").animate({scrollTop: 0}, 1000); {% endblock %} {% block related-plugin %} <script src="{% static 'account/js/plugin/datatables/jquery.dataTables.min.js' %}"></script> <script src="{% static 'account/js/plugin/datatables/dataTables.colVis.min.js' %}"></script> <script src="{% static 'account/js/plugin/datatables/dataTables.tableTools.min.js' %}"></script> <script src="{% static 'account/js/plugin/datatables/dataTables.bootstrap.min.js' %}"></script> <script src="{% static 'account/js/plugin/datatable-responsive/datatables.responsive.min.js' %}"></script> <script src="{% static 'account/js/jquery.sparkline.js' %}"></script> <script src="{% static 'account/js/plugin/moment/moment.min.js' %}"></script> <script src="{% static 'account/js/plugin/chartjs/chart.min.js' %}"></script> <script src="{% static 'account/js/highchart/highcharts.js' %}"></script> <script src="{% static 'account/js/highchart/data.js' %}"></script> <script src="{% static 'account/js/highchart/drilldown.js' %}"></script> <script src="{% static 'account/js/highchart/exporting.js' %}"></script> <script src="{% static 'account/js/highchart/export-data.js' %}"></script> <script src="{% static 'account/js/highchart/accessibility.js' %}"></script> {% endblock %}